<?xml version="1.0"?>
<ruleset name="Jaxboards">
  <description>Jaxboards PHP coding standards</description>
  <!-- Files and directories to run on -->
  <file>Script</file>
  <file>Service</file>
  <file>acp</file>
  <file>config.default.php</file>
  <file>domaindefinitions.php</file>
  <file>inc</file>
  <file>index.php</file>
  <file>misc</file>
  <file>php_codesniffer_to_sonarqube.php</file>
  <!-- ignore vendor files -->
  <exclude-pattern>*/vendor/*</exclude-pattern>
  <exclude-pattern>*/node_modules/*</exclude-pattern>
  <!-- show colors -->
  <arg name="colors" />
  <!-- only check php files -->
  <arg name="extensions" value="php" />
  <!-- Follow PSR coding style guides -->
  <!-- PSR12: Extended Coding Style https://www.php-fig.org/psr/psr-12 -->
  <rule ref="PSR12">
    <!-- Disable these rules as they require big changes to the codebase -->
    <exclude name="PSR1.Files.SideEffects" />
    <exclude name="PSR1.Classes.ClassDeclaration" />
    <exclude name="PSR1.Methods.CamelCapsMethodName" />
    <exclude name="Squiz.Classes.ValidClassName" />
  </rule>
  <!-- Here's some comment rules we can follow -->
  <rule ref="Squiz.Commenting.InlineComment">
    <exclude name="Squiz.Commenting.InlineComment.NotCapital" />
    <exclude name="Squiz.Commenting.InlineComment.InvalidEndChar" />
  </rule>
  <rule ref="Squiz.Commenting.PostStatementComment" />
  <rule ref="Squiz.Commenting.BlockComment">
    <exclude name="Squiz.Commenting.BlockComment.NotCapital" />
    <exclude name="Squiz.Commenting.BlockComment.InvalidEndChar" />
  </rule>
  <!-- Make sure this works with PHP 8.3+ -->
  <config name="testVersion" value="8.3-" />
  <rule ref="PHPCompatibility" />

  <!-- Ban some functions -->
  <rule ref="Generic.PHP.ForbiddenFunctions">
    <properties>
      <property name="forbiddenFunctions" type="array" value="_=>gettext,chop=>rtrim,close=>closedir,com_get=>com_propget,com_propset=>com_propput,com_set=>com_propput,create_function' => null,delete=>unset,die=>exit,diskfreespace=>disk_free_space,doubleval=>floatval,fputs=>fwrite,gzputs=>gzwrite,i18n_convert=>mb_convert_encoding,i18n_discover_encoding=>mb_detect_encoding,i18n_http_input=>mb_http_input,i18n_http_output=>mb_http_output,i18n_internal_encoding=>mb_internal_encoding,i18n_ja_jp_hantozen=>mb_convert_kana,i18n_mime_header_decode=>mb_decode_mimeheader,i18n_mime_header_encode=>mb_encode_mimeheader,imap_create=>imap_createmailbox,imap_fetchtext=>imap_body,imap_getmailboxes=>imap_list_full,imap_getsubscribed=>imap_lsub_full,imap_header=>imap_headerinfo,imap_listmailbox=>imap_list,imap_listsubscribed=>imap_lsub,imap_rename=>imap_renamemailbox,imap_scan=>imap_listscan,imap_scanmailbox=>imap_listscan,ini_alter=>ini_set,is_double=>is_float,is_integer=>is_int,is_long=>is_int,is_null' => null,is_real=>is_float,is_writeable=>is_writable,join=>implode,key_exists=>array_key_exists,ldap_close=>ldap_unbind,mbstrcut=>mb_strcut,mbstrlen=>mb_strlen,mbstrpos=>mb_strpos,mbstrrpos=>mb_strrpos,mbsubstr=>mb_substr,md5=>hash,md5_file=>hash_file,mysql=>mysql_db_query,mysql_affected_rows=>mysqli_affected_rows,mysql_client_encoding' => null,mysql_close=>mysqli_close,mysql_connect=>mysqli_connect,mysql_create_db' => null,mysql_createdb=>mysql_create_db,mysql_data_seek=>mysqli_data_seek,mysql_db_name' => null,mysql_db_query' => null,mysql_dbname=>mysql_result,mysql_drop_db' => null,mysql_dropdb=>mysql_drop_db,mysql_errno=>mysqli_errno,mysql_error=>mysqli_error,mysql_escape_string=>mysqli_escape_string,mysql_fetch_array=>mysqli_fetch_array,mysql_fetch_assoc=>mysqli_fetch_assoc,mysql_fetch_field=>mysqli_fetch_field,mysql_fetch_lengths=>mysqli_fetch_lengths,mysql_fetch_object=>mysqli_fetch_object,mysql_fetch_row=>mysqli_fetch_row,mysql_field_flags' => null,mysql_field_len' => null,mysql_field_name' => null,mysql_field_seek=>mysqli_field_seek,mysql_field_table' => null,mysql_field_type' => null,mysql_fieldflags=>mysql_field_flags,mysql_fieldlen=>mysql_field_len,mysql_fieldname=>mysql_field_name,mysql_fieldtable=>mysql_field_table,mysql_fieldtype=>mysql_field_type,mysql_free_result=>mysqli_free_result,mysql_freeresult=>mysql_free_result,mysql_get_client_info=>mysqli_get_client_info,mysql_get_host_info=>mysqli_get_host_info,mysql_get_proto_info=>mysqli_get_proto_info,mysql_get_server_info=>mysqli_get_server_info,mysql_info=>mysqli_info,mysql_insert_id=>mysqli_insert_id,mysql_list_dbs' => null,mysql_list_fields' => null,mysql_list_processes' => null,mysql_list_tables' => null,mysql_listdbs=>mysql_list_dbs,mysql_listfields=>mysql_list_fields,mysql_listtables=>mysql_list_tables,mysql_num_fields=>mysqli_num_fields,mysql_num_rows=>mysqli_num_rows,mysql_numfields=>mysql_num_fields,mysql_numrows=>mysql_num_rows,mysql_pconnect' => null,mysql_ping=>mysqli_ping,mysql_query=>mysqli_query,mysql_real_escape_string=>mysqli_real_escape_string,mysql_result' => null,mysql_select_db=>mysqli_select_db,mysql_selectdb=>mysql_select_db,mysql_set_charset=>mysqli_set_charset,mysql_stat=>mysqli_stat,mysql_tablename' => null,mysql_thread_id=>mysqli_thread_id,mysql_unbuffered_query' => null,ociassignelem=>OCICollection::assignElem,ocibindbyname=>oci_bind_by_name,ocicancel=>oci_cancel,ocicloselob=>OCILob::close,ocicollappend=>OCICollection::append,ocicollassign=>OCICollection::assign,ocicollmax=>OCICollection::max,ocicollsize=>OCICollection::size,ocicolltrim=>OCICollection::trim,ocicolumnisnull=>oci_field_is_null,ocicolumnname=>oci_field_name,ocicolumnprecision=>oci_field_precision,ocicolumnscale=>oci_field_scale,ocicolumnsize=>oci_field_size,ocicolumntype=>oci_field_type,ocicolumntyperaw=>oci_field_type_raw,ocicommit=>oci_commit,ocidefinebyname=>oci_define_by_name,ocierror=>oci_error,ociexecute=>oci_execute,ocifetch=>oci_fetch,ocifetchstatement=>oci_fetch_all,ocifreecollection=>OCICollection::free,ocifreecursor=>oci_free_statement,ocifreedesc=>oci_free_descriptor,ocifreestatement=>oci_free_statement,ocigetelem=>OCICollection::getElem,ociinternaldebug=>oci_internal_debug,ociloadlob=>OCILob::load,ocilogon=>oci_connect,ocinewcollection=>oci_new_collection,ocinewcursor=>oci_new_cursor,ocinewdescriptor=>oci_new_descriptor,ocinlogon=>oci_new_connect,ocinumcols=>oci_num_fields,ociparse=>oci_parse,ocipasswordchange=>oci_password_change,ociplogon=>oci_pconnect,ociresult=>oci_result,ocirollback=>oci_rollback,ocisavelob=>OCILob::save,ocisavelobfile=>OCILob::import,ociserverversion=>oci_server_version,ocisetprefetch=>oci_set_prefetch,ocistatementtype=>oci_statement_type,ociwritelobtofile=>OCILob::export,ociwritetemporarylob=>OCILob::writeTemporary,odbc_do=>odbc_exec,odbc_field_precision=>odbc_field_len,pg_clientencoding=>pg_client_encoding,pg_setclientencoding=>pg_set_client_encoding,pos=>current,print=>echo,recode=>recode_string,show_source=>highlight_file,sizeof=>count,snmpwalkoid=>snmprealwalk,strchr=>strstr,stripos=>mb_stripos,stristr=>mb_stristr,strlen=>mb_strlen,strpos=>mb_strpos,strrchr=>mb_strrchr,strrichr=>mb_strrichr,strripos=>mb_strripos,strrpos=>mb_strrpos,strstr=>mb_strstr,strtolower=>mb_strtolower,strtoupper=>mb_strtoupper,substr=>mb_substr,substr_count=>mb_substr_count" />
    </properties>
  </rule>
</ruleset>
